////////////////////////////////////////////////////////////////////////////
//
// Summit Route End Point Protection
//
// This source code is licensed under the BSD-style license found in the
// LICENSE file in the root directory of this source tree.
//
/////////////////////////////////////////////////////////////////////////////

#pragma once
#include "..\common\drivercomm.h"
#include <windows.h>

extern "C"
{
	// Define callback for QdMonitor
	typedef DWORD(*t_processMonitorCallback)(PCOMM_CREATE_PROC pComm_Create_Proc);


	///////////////////////////////////////////////////////////////////////////////
	///
	///  Retrieve info about new processes being created from the driver
	///
	///////////////////////////////////////////////////////////////////////////////
	__declspec(dllexport) BOOL QdMonitor(t_processMonitorCallback processMonitorCallback);


	///////////////////////////////////////////////////////////////////////////////
	///
	/// Tell the driver to allow or deny a process
	///
	///////////////////////////////////////////////////////////////////////////////
	__declspec(dllexport) BOOL QdControl(USHORT decision, USHORT integrityCheck);


	///////////////////////////////////////////////////////////////////////////////
	///
	///  Installs the kernel driver
	///
	///////////////////////////////////////////////////////////////////////////////
	__declspec(dllexport) BOOL QdInstallDriver();


	///////////////////////////////////////////////////////////////////////////////
	///
	///  Uninstalls the kernel driver
	///
	///////////////////////////////////////////////////////////////////////////////
	__declspec(dllexport) BOOL QdUninstallDriver();


	///////////////////////////////////////////////////////////////////////////////
	///
	///  Initialize globals
	///
	///////////////////////////////////////////////////////////////////////////////
	__declspec(dllexport) BOOL QdInitialize();


	///////////////////////////////////////////////////////////////////////////////
	///
	///  Cleanup
	///
	///////////////////////////////////////////////////////////////////////////////
	__declspec(dllexport) BOOL QdUnInitialize();
}